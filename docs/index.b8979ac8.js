!function(e,n,t,o,a){var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},c="function"==typeof r.parcelRequire1b1f&&r.parcelRequire1b1f,s=c.cache||{},d="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function i(n,t){if(!s[n]){if(!e[n]){var o="function"==typeof r.parcelRequire1b1f&&r.parcelRequire1b1f;if(!t&&o)return o(n,!0);if(c)return c(n,!0);if(d&&"string"==typeof n)return d(n);var a=new Error("Cannot find module '"+n+"'");throw a.code="MODULE_NOT_FOUND",a}f.resolve=function(t){return e[n][1][t]||t},f.cache={};var l=s[n]=new i.Module(n);e[n][0].call(l.exports,f,l,l.exports,this)}return s[n].exports;function f(e){return i(f.resolve(e))}}i.isParcelRequire=!0,i.Module=function(e){this.id=e,this.bundle=i,this.exports={}},i.modules=e,i.cache=s,i.parent=c,i.register=function(n,t){e[n]=[function(e,n){n.exports=t},{}]},Object.defineProperty(i,"root",{get:function(){return r.parcelRequire1b1f}}),r.parcelRequire1b1f=i;for(var l=0;l<n.length;l++)i(n[l]);var f=i(t);"object"==typeof exports&&"undefined"!=typeof module?module.exports=f:"function"==typeof define&&define.amd&&define((function(){return f}))}({"1y5xM":[function(e,n,t){e("./bundle-manifest").register(JSON.parse('{"4Wj8R":"index.b8979ac8.js","2qsS8":"editor.main.75d43fa4.js","4qp3A":"tsMode.d517547d.js","67MXJ":"editor.main.b4eb7f88.css","1wPZq":"codicon.5d924380.ttf","1WLDS":"cssMode.da62f1fe.js","9QbNY":"jsonMode.bb19ab48.js","3th4v":"htmlMode.41fd4fd1.js","7G0f9":"abap.8d4df825.js","2gpRl":"apex.7d0d5697.js","2tF4d":"azcli.815ad230.js","12jI5":"bat.9498510c.js","m2KUw":"cameligo.0e7add89.js","56goV":"clojure.7eb95a0c.js","7G9sE":"coffee.321f3c7e.js","3b933":"cpp.45bf3d23.js","3uGUz":"csharp.0a1e8d71.js","4kT6F":"csp.0649c24b.js","4LNzc":"css.074b639e.js","4Yh3i":"dart.f6aecf4b.js","7aIDg":"dockerfile.1b097059.js","168kv":"ecl.116cc9ba.js","5d6VJ":"fsharp.24ae2f45.js","Xqs9s":"go.b48b1d80.js","7pbxZ":"graphql.a60ca07d.js","6ZIm6":"handlebars.1bf66e36.js","1AxeD":"hcl.a823c8ec.js","B8xmW":"html.895c8dbb.js","66aun":"ini.169d81c5.js","687GW":"java.b0da111b.js","2OgUR":"javascript.43dc8bc8.js","7BHOy":"typescript.267d0d8e.js","5C1EP":"julia.10085055.js","4AbEW":"kotlin.dba91794.js","1rWB3":"less.a4c67063.js","35X92":"lexon.249d395f.js","1siDl":"lua.d539db68.js","3NDNv":"m3.277fca01.js","1Ezv6":"markdown.aab2f399.js","1rF17":"mips.fb46f0a5.js","2dteV":"msdax.f4a2631e.js","7aUGu":"mysql.0fa81fa0.js","32IOb":"objective-c.b78c80cb.js","2oEBQ":"pascal.b9b12047.js","1HIsG":"pascaligo.36f78056.js","7EvUg":"perl.9fbba7b1.js","5nfPt":"pgsql.93008727.js","1P17k":"php.a44f0cbc.js","724E4":"postiats.0648e94c.js","34wHp":"powerquery.d3ca9517.js","4He3t":"powershell.72fb8003.js","2vTki":"pug.7d18c728.js","5FPyZ":"python.1e374bf9.js","3myoS":"r.90248160.js","6bEeY":"razor.c34b5ab4.js","5qvzr":"redis.5b670da3.js","2gwzx":"redshift.c1e4341d.js","2IUHv":"restructuredtext.dd29dcc3.js","65a0z":"ruby.195a2afe.js","7Kgp8":"rust.7c2f2ded.js","2BRRk":"sb.14bfce40.js","2IRXj":"scala.4641af50.js","1jPiH":"scheme.c28a73af.js","1Nizj":"scss.68df51c6.js","1LID8":"shell.ab4d770a.js","48r2M":"solidity.06cea41a.js","3bFmG":"sophia.2213e58a.js","4Dg6M":"sql.d5091cf2.js","1SoFe":"st.e3f4cf71.js","1eqng":"swift.674efebd.js","7a2jJ":"systemverilog.38efa940.js","6z0n6":"tcl.4f56fd54.js","6cBS7":"twig.2bbaf48e.js","7iAfL":"vb.bf9e9e1f.js","3L5sq":"xml.f31554a3.js","5VefZ":"yaml.361596db.js","4GH9F":"editor.main.c26c3472.js","2LFV6":"bittorrent-tracker.00a6b2b0.js"}'))},{"./bundle-manifest":"4Uuyi"}],"4Uuyi":[function(e,n,t){"use strict";var o={};n.exports.register=function(e){for(var n=Object.keys(e),t=0;t<n.length;t++)o[n[t]]=e[n[t]]},n.exports.resolve=function(e){var n=o[e];if(null==n)throw new Error("Could not resolve bundle with id "+e);return n}},{}],"1rPMx":[function(e,n,t){e("monaco-editor");function o(){const e=[],n="0123456789abcdef";for(let t=0;t<40;t++)e.push(n[Math.floor(Math.random()*n.length)]);return e.join("")}const a=o();let r=null;const c=new Map;let s=null,d=null,i=null;const l=document.querySelector("select#languages");let f=!0;const u=new Set;function b(){const e=[`<li>${s}</li>`];for(const n of c.values())e.push(`<li>${n.displayName}</li>`);document.querySelector("#peers").innerHTML=e.join("")}function H(){const e=o();window.location.href=window.location.pathname+"?room="+encodeURIComponent(function(e){let n="";for(let t=0;t<e.length;t+=2)n+=String.fromCharCode(parseInt(e.substr(t,2),16));return btoa(n)}(e))}async function p(n){const t=localStorage.getItem("editor-name");s=null==t?prompt("Your name is..."):prompt("Your name is...",t),null!=s&&""!==s||(s=`Peer ${a.slice(0,8)}`),localStorage.setItem("editor-name",s),b();const o=await e("bittorrent-tracker");var H;r=new o({infoHash:(H=n,atob(H).split("").map((e=>e.charCodeAt(0).toString(16).padStart(2,"0"))).join("")),peerId:a,announce:["wss://tracker.openwebtorrent.com","wss://tracker.btorrent.xyz"]}),console.debug("tracker:",r),r.setInterval(9e5),r.on("warning",console.warn),r.on("error",(e=>{u.delete(e.announce),console.log("num connected trackers:",u.size),0===u.size&&(document.querySelector("#connection-status").textContent="Connecting...")})),r.on("peer",(n=>{console.debug("peer:",n);const t=n.id;40!==t.length||c.has(t)||n.on("connect",(()=>{!function(n){const t=n.id,o={lineNumber:1,column:1},a={selectionStartLineNumber:0,selectionStartColumn:0,positionLineNumber:0,positionColumn:0};c.set(t,{displayName:"",conn:n,position:o,positionDecorations:[],selection:a,selectionDecorations:[]}),n.on("data",(n=>async function(n,t){const o=JSON.parse(new TextDecoder("utf-8").decode(t));console.debug("incoming:",o);const a=c.get(n);if(null==a)return;if(null==i)return;const r=await e("monaco-editor");if(f=!1,"edits"===o.type){const e=o.value.map((e=>{const n=e.range;return{range:new r.Range(n.startLineNumber,n.startColumn,n.endLineNumber,n.endColumn),text:e.text,forceMoveMarkers:!0}}));i.pushEditOperations([],e,(()=>null)),console.debug("incoming done")}else"greet"===o.type?(a.displayName=o.value,b()):"state"===o.type?(i.setValue(o.value),l.value=o.language,r.editor.setModelLanguage(i,o.language)):"cursor"===o.type?(a.position=o.value,async function(n){const t=await e("monaco-editor");console.debug("new peer position:",n.position),n.positionDecorations=d.deltaDecorations(n.positionDecorations,[{range:new t.Range(n.position.lineNumber,n.position.column,n.position.lineNumber,n.position.column),options:{className:"peer-cursor"}}])}(a)):"changeLanguage"===o.type?(l.value=o.value,r.editor.setModelLanguage(i,o.value)):"selection"===o.type&&(a.selection=o.value,async function(n){const t=await e("monaco-editor");console.debug("new peer selection:",n.selection),n.selectionDecorations=d.deltaDecorations(n.selectionDecorations,[{range:new t.Range(n.selection.selectionStartLineNumber,n.selection.selectionStartColumn,n.selection.positionLineNumber,n.selection.positionColumn),options:{className:"peer-selection"}}])}(a));f=!0}(t,n))),n.on("close",(()=>{console.debug("peer closed:",n.id);const e=c.get(n.id);e&&(d?.deltaDecorations(e.positionDecorations,[]),c.delete(n.id)),b()})),n.on("error",(e=>{c.has(n.id)&&console.error("peer error:",e)})),n.send(JSON.stringify({type:"greet",value:s}));const r=i.getValue();r.length>0&&n.send(JSON.stringify({type:"state",value:r,language:l.value}));const u=d?.getPosition();null!=u&&n.send(JSON.stringify({type:"cursor",value:u}))}(n),b()}))})),r.on("update",(e=>{u.add(e.announce),document.querySelector("#connection-status").textContent="connected",console.log("num connected trackers:",u.size)})),r.start()}function _(e){console.debug("broadcasting to:",c);const n=JSON.stringify(e);for(const e of c.values())try{e.conn.send(n)}catch{}}console.info("peerId:",a),async function(){const n=new URLSearchParams(window.location.search).get("room");if(!n){const e=document.querySelector("#new-room");return e.addEventListener("click",H,!1),void(e.style.display="block")}document.querySelector("#container").style.display="grid",p(n);const t=await e("monaco-editor");d=t.editor.create(document.getElementById("editor"),{value:"",language:"plaintext",scrollBeyondLastLine:!1}),console.debug("editor:",d),i=d.getModel(),console.debug("model:",i),i.onDidChangeContent((e=>{console.debug("changeContent:",e),f&&_({type:"edits",value:e.changes})})),d.onDidChangeCursorPosition((e=>{console.debug("changeCursor:",e),_({type:"cursor",value:e.position})})),d.onDidChangeCursorSelection((e=>{console.debug("selection:",e.selection),_({type:"selection",value:e.selection})})),l.innerHTML=t.languages.getLanguages().filter((e=>void 0!==e.aliases)).map((e=>`<option value="${e.id}">${e.aliases[0]}</option>`)).join(""),l.addEventListener("change",(e=>{t.editor.setModelLanguage(i,l.value),_({type:"changeLanguage",value:l.value})})),window.addEventListener("beforeunload",(function(){for(const e of c.values())e.conn.destroy();r.stop()}))}()},{"monaco-editor":"CaE2c","bittorrent-tracker":"2bdWH"}],CaE2c:[function(e,n,t){n.exports=Promise.all([e("./loaders/browser/css-loader")(e("./bundle-url").getBundleURL()+e("./relative-path")("4Wj8R","67MXJ")),e("./loaders/browser/js-loader")(e("./bundle-url").getBundleURL()+e("./relative-path")("4Wj8R","4GH9F")),e("./loaders/browser/js-loader")(e("./bundle-url").getBundleURL()+e("./relative-path")("4Wj8R","2qsS8"))]).then((()=>n.bundle.root("6Rb5J")))},{"./loaders/browser/css-loader":"bg1Qc","./bundle-url":"1iUdH","./relative-path":"3fteO","./loaders/browser/js-loader":"4CNY7"}],bg1Qc:[function(e,n,t){const o=e("../../cacheLoader");n.exports=o((function(e){return new Promise((function(n,t){let o=document.getElementsByTagName("link");if([].concat(o).some((function(n){return n.href===e&&n.rel.indexOf("stylesheet")>-1})))n();else{var a=document.createElement("link");a.rel="stylesheet",a.href=e,a.onerror=function(e){a.onerror=a.onload=null,a.remove(),t(e)},a.onload=function(){a.onerror=a.onload=null,n()},document.getElementsByTagName("head")[0].appendChild(a)}}))}))},{"../../cacheLoader":"470Fa"}],"470Fa":[function(e,n,t){"use strict";let o={},a={},r={};function c(e){switch(e){case"preload":return a;case"prefetch":return r;default:return o}}n.exports=function(e,n){return function(t){let o=c(n);return o[t]?o[t]:o[t]=e.apply(null,arguments).catch((function(e){throw delete o[t],e}))}}},{}],"1iUdH":[function(e,n,t){"use strict";var o=null;function a(e){return(""+e).replace(/^((?:https?|file|ftp):\/\/.+)\/[^/]+$/,"$1")+"/"}t.getBundleURL=function(){return o||(o=function(){try{throw new Error}catch(n){var e=(""+n.stack).match(/(https?|file|ftp):\/\/[^)\n]+/g);if(e)return a(e[0])}return"/"}()),o},t.getBaseURL=a,t.getOrigin=function(e){let n=(""+e).match(/(https?|file|ftp):\/\/[^/]+/);if(!n)throw new Error("Origin not found");return n[0]}},{}],"3fteO":[function(e,n,t){"use strict";var o=e("./bundle-manifest").resolve;function a(e){if(""===e)return".";var n="/"===e[e.length-1]?e.slice(0,e.length-1):e,t=n.lastIndexOf("/");return-1===t?".":n.slice(0,t)}function r(e,n){if(e===n)return"";var t=e.split("/");"."===t[0]&&t.shift();var o,a,r=n.split("/");for("."===r[0]&&r.shift(),o=0;(o<r.length||o<t.length)&&null==a;o++)t[o]!==r[o]&&(a=o);var c=[];for(o=0;o<t.length-a;o++)c.push("..");return r.length>a&&c.push.apply(c,r.slice(a)),c.join("/")}n.exports=function(e,n){return r(a(o(e)),o(n))},n.exports._dirname=a,n.exports._relative=r},{"./bundle-manifest":"4Uuyi"}],"4CNY7":[function(e,n,t){const o=e("../../cacheLoader");n.exports=o((function(e){return new Promise((function(n,t){let o=document.getElementsByTagName("script");if([].concat(o).some((function(n){return n.src===e})))n();else{var a=document.createElement("script");a.async=!0,a.type="text/javascript",a.charset="utf-8",a.src=e,a.onerror=function(e){a.onerror=a.onload=null,a.remove(),t(e)},a.onload=function(){a.onerror=a.onload=null,n()},document.getElementsByTagName("head")[0].appendChild(a)}}))}))},{"../../cacheLoader":"470Fa"}],"2bdWH":[function(e,n,t){n.exports=Promise.all([e("./loaders/browser/js-loader")(e("./bundle-url").getBundleURL()+e("./relative-path")("4Wj8R","4GH9F")),e("./loaders/browser/js-loader")(e("./bundle-url").getBundleURL()+e("./relative-path")("4Wj8R","2LFV6"))]).then((()=>n.bundle.root("PcXD7")))},{"./loaders/browser/js-loader":"4CNY7","./bundle-url":"1iUdH","./relative-path":"3fteO"}]},["1y5xM","1rPMx"],"1rPMx");